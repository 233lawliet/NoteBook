## 常见函数 ##



### 函数作用 ###

- 隐蔽了实现细节
- 提高了代码的重用率




### 函数分类 ###

- 单行函数：传入一个值，返回操作结果
    - 字符函数
    - 数学函数
    - 日期函数
    - 其他函数（补充）
    - 流程控制函数 ：if else switch case
- 分组函数（统计函数）：对多个数据进行操作，统计
    - sum,avg,min,max,count五个


#### 字符函数 ####

- 字节长度函数：length()
  
        select length("李路通")
        
        输出：9

注释：utf8：汉字3字节，英文1字节。gbk:汉字2字节，英文1字节。
      


- 拼接函数concat()

        select concat("li","_"lutong") 
 
        输出：li_lutong  


- 大写，小写函数upper(),lower()
    - 内容全部大写，或者全部小写

            select concat(upper(last_name),lower(first_name)) 

            输出：LIlutong




- 截取函数substr()或者substring()
    - 索引是从1开始。例如：substr(str,1,1)截取第一个
    - 截取的是字符，不是字节
    

            select substr("李莫愁爱上了陆展远",7)
            select substr("李莫愁爱上了陆展远",1,3)
            
            输出：陆展远
                 李莫愁



- 获取下标函数instr()
    - 获取第一次出现的索引
    - 没有返回0
  

            select instr("ABCDE","DE")
            输出：4 

- 去除前后空格或其他trim() 

        select  trim("    abc    ")
        select  trim("a" from "aaaab caaaaa")
        
        
        输出:abc
             b c

- 左填充,有填充，指定长度 lpad()，rpad()
    - lpad(待填充字符，长度，填充内容)
    - 如果长度小于要求长度，则会左截取至指定长度


            select  lpad("你好",5,"_")                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
            select  lpad("你好",1,"_")
            
            输出：___你好
                 好


- 替换字符replace()
    - replace(原始字符，待换字符，目的字符)
    - 全部替换

            select("李李李路通","李","li")
            输出：lilili路通



#### 数学函数 ####

- 四舍五入函数round()
    - 对于负数，绝对值四舍五入，再加上负号
    - round()默认是四舍五入取整，也可以小数位四舍五入

            select round(0.5)
            select  round(1.23,1)
            
            输出：1
                  1，2



- 向上取整函数ceil()
    
    - 向上取大于等于的数
        
            select ceil(1.001)
            select ceil(1.00)
            select  ceil(-1.001)
            
            输出：2
                 1
                 -1
    
- 向下取整函数floor()
    - 向下小于等于取整
    
            select floor(1.00)
            select floor(1.23)
            select floor(-1.1)
            
            输出：1
                 1
                 -2 


- 截断函数truncate()
    - 表达式 truncate(数,位数)
    
            select  truncate(1.23,1)
            
            输出：1.2



- 取余运算函数mod()

        select mod(10,3)
        输出：1


#### 日期函数 ####

- 当前的日期和时间now()
- 当前的日期curdate()
- 当前的时间curtime()

        select NOW();
        select CURDATE();
        SELECT CURTIME();
        
        输出：2019-01-19 19:45:42
              2019-01-19 
              19:45:42

- 获取年,月,日,时,分,秒,
    - year(时间)
    - month(时间)
    - ……
    
            select  year(now())
            19:45:42


- 字符串转时间类型str_to_date()
    - 格式：str_to_date(字符串，字符串的格式)
    
            select   STR_TO_DATE("1997-05-18","%Y-%m-%d")
            select  * from employees where hirdate= STR_TO_DATE("18-05-1997-","%d-%m-%Y-")
            输出：1997-05-18

    - 常见格式

    ![](https://i.imgur.com/wRBvgqt.png)



- 日期转换成字符串date_format()

        select DATE_FORMAT(now(),"%Y年%m月%d天")
        
        输出：2019年01月19天

- 时间天数差值datediff()

        SELECT  DATEDIFF(now(),"1997-05-18")
        
        输出：7916

#### 其他函数 ####




- 查看版本：select version()
- 查看当前的库：select database()
- 查看当前的用户：select user()



#### 流程控制函数 ####


- if()函数
    - if(判定，ture的返回，false的返回)
    - 类似三元运算符

            select if(account = "李路通","T","F") from user
            
            输出：T
                 F
                 …… 

- case函数

    - 使用方法1：语法结构

            case 判定的字段
            when 常量1 then 显示的值1
            when 常量2 then 显示的值2
            when 常量3 then 显示的值3
            when 常量4 then 显示的值4
            else 显示的值5
            end
    - 举例子

            select salary 原始工资 ,
            
            case departmentId
            when 1 then salary*1.1
            when 2 then salary*1.2
            else salary
            end
            as newSalary
            from employees;             

    - 使用方法2：（区间判定）

            case 
            when 判定1 then 显示的值1
            when 判定2 then 显示的值2
            when 判定3 then 显示的值3
            when 判定4 then 显示的值4
            else 显示的值5
            end

    - 举例子

            select name ,
            case salary
            when salary>10000 then "A"
            when salary>8000 then "B" 
            else "C"
            end
            as level
            from employees; 



### 分组函数 ###

- 功能：用于统计使用。（把多组->单个输出
- 又称作聚合函数，统计函数，组函数





**求和函数sum()**

- 表达式  ：select  sum(字段) from 表；
- 返回整张表的统计和

**求平均数函数avg()**

- 表达式  ：select  avg(字段) from 表；
- 返回整张表的统计平均数

**求最大值函数max()**

- 表达式  ：select  max(字段) from 表；
- 返回整张表的统计最大值

**求最小值函数min()**

- 表达式  ：select  min(字段) from 表；
- 返回整张表的统计最小值

**求个数函数count()**

- 表达式  ：select  count(字段) from 表；
- 返回整张表的统计个数


#### 关于函数的特点 ####


- sum函数，avg函数只支持数字类型
- max函数,nin函数，count函数支持所有类型
- 五个函数都忽略了null值
- 五个函数可以和distinct搭配

        select sum(distinct name) from emploees

- count函数
    - 统计表的行数

            select count(*) from employees;
            或者：select count(1) from employees;

    - 效率问题   
        - 现在的存储引擎INNODB，count(*)和count(1)基本一致
        - 过去使用的存储引擎NYISAM，count(*)效率高
        - 因此：一般使用count(*)

- 单行函数和分组函数一起查询有限制，要求group by